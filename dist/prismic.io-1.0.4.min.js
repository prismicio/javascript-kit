/*! prismic.io 1.0.4 2013-12-08 */
!function(a,b){"use strict";function c(a,b,c,d,e,f){this.name=a,this.fields=b,this.form_method=c,this.rel=d,this.enctype=e,this.action=f}function d(a,b,c){this.api=a,this.form=b,this.data=c||{};for(var d in b.fields)b.fields[d].default&&(this.data[d]=[b.fields[d].default])}function e(a){return this.fragments&&this.fragments[a]?Array.isArray(this.fragments[a])?this.fragments[a]:[this.fragments[a]]:[]}function f(a,b,c,d,e,f){this.id=a,this.type=b,this.href=c,this.tags=d,this.slug=e?e[0]:"-",this.fragments=f}function g(a,b,c){this.ref=a,this.label=b,this.isMaster=c}var h=function(a,b,c,d){var e=new h.fn.init(a,c,d);return b&&e.get(b),e},i=function(){return"undefined"!=typeof XMLHttpRequest?function(a,b){var c=new XMLHttpRequest,d=function(){b(JSON.parse(c.responseText))},e=function(){var a=c.status;throw new Error("Unexpected status code ["+a+"]")};c.onreadystatechange=function(){4===c.readyState&&(c.status&&200==c.status?d(c):e(c))},c.open("GET",a+"#json",!0),c.setRequestHeader("Accept","application/json"),c.send()}:void 0},j=function(){if("function"==typeof require&&require("http")){{var a={},c=require("http"),d=require("https"),e=require("url");require("querystring")}return function(f,g){if(a[f])g(a[f]);else{var h=e.parse(f),i="https:"==h.protocol?d:c,j={hostname:h.hostname,path:h.path,query:h.query,headers:{Accept:"application/json"}};i.get(j,function(c){if(!c.statusCode||200!=c.statusCode)throw new Error("Unexpected status code ["+c.statusCode+"]");var d="";c.setEncoding("utf8"),c.on("data",function(a){d+=a}),c.on("end",function(){var e=c.headers["cache-control"],h=e&&/max-age=(\d+)/.test(e)?parseInt(/max-age=(\d+)/.exec(e)[1]):b,i=JSON.parse(d);h&&(a[f]=i),g(i)})})}}}};h.fn=h.prototype={constructor:h,data:null,get:function(a){var b=this;this.requestHandler(this.url,function(c){b.data=b.parse(c),b.bookmarks=b.data.bookmarks,a&&a(b,this)})},parse:function(a){var b,d,e,f,h,i={};for(h in a.forms)a.forms.hasOwnProperty(h)&&(f=a.forms[h],this.accessToken&&(f.fields.accessToken={type:"string","default":this.accessToken}),e=new c(f.name,f.fields,f.form_method,f.rel,f.enctype,f.action),i[h]=e);if(b=a.refs.map(function(a){return new g(a.ref,a.label,a.isMasterRef)})||[],d=b.filter(function(a){return a.isMaster===!0}),0===d.length)throw"No master ref.";return{bookmarks:a.bookmarks||{},refs:b,forms:i,master:d[0],oauthInitiate:a.oauth_initiate,oauthToken:a.oauth_token}},init:function(a,b,c){return this.url=a+(b?(a.indexOf("?")>-1?"&":"?")+"access_token="+b:""),this.accessToken=b,this.requestHandler=c||i()||j()||function(){throw new Error("No request handler available (tried XMLHttpRequest & NodeJS)")}(),this},forms:function(a){return this.form(a)},form:function(a){var b=this.data.forms[a];return b?new d(this,b,{}):void 0},master:function(){return this.data.master.ref},ref:function(a){for(var b=0;b<this.data.refs.length;b++)if(this.data.refs[b].label==a)return this.data.refs[b].ref}},h.fn.init.prototype=h.fn,c.prototype={},d.prototype={set:function(a,b){var c=this.form.fields[a];if(!c)throw new Error("Unknown field "+a);var d=this.data[a]||[];return c.multiple?d.push(b):d=[b],this.data[a]=d,this},ref:function(a){return this.set("ref",a)},query:function(a){return this.form.fields.q.multiple?this.set("q",a):(this.data.q=this.data.q||[],this.data.q.push(a),this)},submit:function(a){var b=this.form.action;if(this.data){var c=b.indexOf("?")>-1?"&":"?";for(var d in this.data){var e=this.data[d];if(e)for(var g=0;g<e.length;g++)b+=c+d+"="+encodeURIComponent(e[g]),c="&"}}this.api.requestHandler(b,function(b){var c=b.results||b,d=c.map(function(a){var b={};for(var c in a.data[a.type])b[a.type+"."+c]=a.data[a.type][c];return new f(a.id,a.type,a.href,a.tags,a.slugs,b)});a&&a(d||[])})}},f.prototype={get:function(b){var c=e.call(this,b);return c.length?a.Prismic.Fragments.initField(c[0]):null},getAll:function(b){return e.call(this,b).map(function(b){return a.Prismic.Fragments.initField(b)},this)},getImage:function(b){var c=this.get(b);return c instanceof a.Prismic.Fragments.Image?c:c instanceof a.Prismic.Fragments.StructuredText?c:null},getAllImages:function(b){var c=this.getAll(b);return c.map(function(b){if(b instanceof a.Prismic.Fragments.Image)return b;if(b instanceof a.Prismic.Fragments.StructuredText)throw new Error("Not done.");return null})},getImageView:function(b,c){var d=this.get(b);if(d instanceof a.Prismic.Fragments.Image)return d.getView(c);if(d instanceof a.Prismic.Fragments.StructuredText)for(var e=0;e<d.blocks.length;e++)if("image"==d.blocks[e].type)return d.blocks[e];return null},getAllImageViews:function(a,b){return this.getAllImages(a).map(function(a){return a.getView(b)})},getDate:function(b){var c=this.get(b);return c instanceof a.Prismic.Fragments.Date?c.value:void 0},getBoolean:function(a){var b=this.get(a);return b.value&&("yes"==b.value.toLowerCase()||"on"==b.value.toLowerCase()||"true"==b.value.toLowerCase())},getText:function(b,c){var d=this.get(b);return d instanceof a.Prismic.Fragments.StructuredText?d.blocks.map(function(a){return a.text?a.text+(c?c:""):void 0}).join("\n"):d instanceof a.Prismic.Fragments.Text&&d.value?d.value+(c?c:""):d instanceof a.Prismic.Fragments.Number&&d.value?d.value+(c?c:""):d instanceof a.Prismic.Fragments.Select&&d.value?d.value+(c?c:""):d instanceof a.Prismic.Fragments.Color&&d.value?d.value+(c?c:""):void 0},getStructuredText:function(b){var c=this.get(b);return c instanceof a.Prismic.Fragments.StructuredText?c:void 0},getNumber:function(b){var c=this.get(b);return c instanceof a.Prismic.Fragments.Number?c.value:void 0},getHtml:function(a,b){var c=this.get(a);return c&&c.asHtml?c.asHtml(b):void 0},asHtml:function(a){var b=[];for(var c in this.fragments){var d=this.get(c);b.push(d&&d.asHtml?'<section data-field="'+c+'">'+d.asHtml(a)+"</section>":"")}return b.join("")}},g.prototype={},a.Prismic={Api:h}}("object"==typeof exports&&exports?exports:"object"==typeof module&&module&&"object"==typeof module.exports?module.exports:window),function(a){"use strict";function b(a){this.value=a}function c(a){this.value=a,this.document=a.document,this.isBroken=a.isBroken}function d(a){this.value=a}function e(a){this.value=a}function f(a){this.value=a}function g(a){this.value=a}function h(a){this.value=new Date(a)}function i(a){this.value=a}function j(a,b){this.main=a,this.views=b||{}}function k(a,b,c){this.url=a,this.width=b,this.height=c}function l(a,b){this.tag=a,this.blocks=b}function m(a){this.blocks=a}function n(a){var b,c,d=[],e=[];if(Array.isArray(a)){for(var f=0;f<a.length;f++)c=a[f],"list-item"!=c.type&&"o-list-item"!=c.type?(b=new l(c.type,[]),d.push(b)):b&&b.tag!=c.type&&(b=new l(c.type,[]),d.push(b)),b.blocks.push(c);d.forEach(function(a){if("heading1"==a.tag)e.push("<h1>"+p(a.blocks[0].text,a.blocks[0].spans)+"</h1>");else if("heading2"==a.tag)e.push("<h2>"+p(a.blocks[0].text,a.blocks[0].spans)+"</h2>");else if("heading3"==a.tag)e.push("<h3>"+p(a.blocks[0].text,a.blocks[0].spans)+"</h3>");else if("paragraph"==a.tag)e.push("<p>"+p(a.blocks[0].text,a.blocks[0].spans)+"</p>");else if("image"==a.tag)e.push('<p><img src="'+a.blocks[0].url+'"></p>');else if("embed"==a.tag)e.push('<div data-oembed="'+a.blocks[0].embed_url+'" data-oembed-type="'+a.blocks[0].type+'" data-oembed-provider="'+a.blocks[0].provider_name+'">'+a.blocks[0].oembed.html+"</div>");else{if("list-item"!=a.tag&&"o-list-item"!=a.tag)throw new Error(a.tag+" not implemented");e.push("list-item"==a.tag?"<ul>":"<ol>"),a.blocks.forEach(function(a){e.push("<li>"+p(a.text,a.spans)+"</li>")}),e.push("list-item"==a.tag?"</ul>":"</ol>")}})}return e.join("")}function o(a){return"Link.web"==a.type?a.value.url:""}function p(a,b){var c=[],d=[],e=0,f=[];return b.forEach(function(b){return b.end<b.start?a:b.start<e?a:(e=b.end,void 0)}),e=0,b.forEach(function(b){c.push(a.substring(0,b.start-e)),a=a.substring(b.start-e),e=b.start,c.push(a.substring(0,b.end-e)),a=a.substring(b.end-e),d.push(b),e=b.end}),c.push(a),d.forEach(function(a){f.push(c.shift()),"hyperlink"==a.type?(f.push('<a href="'+o(a.data)+'">'),f.push(c.shift()),f.push("</a>")):(f.push("<"+a.type+">"),f.push(c.shift()),f.push("</"+a.type+">"))}),f.push(c.shift()),f.join("")}function q(a){var i,l;switch(a.type){case"Color":i=new f(a.value);break;case"Number":i=new g(a.value);break;case"Date":i=new h(a.value);break;case"Text":i=new b(a.value);break;case"Embed":throw new Error("not implemented");case"Select":i=new e(a.value);break;case"Image":var l=a.value.main;i=new j(new k(l.url,l.dimensions.width,l.dimensions.height),a.value.views);break;case"StructuredText":i=new m(a.value);break;case"Link.document":i=new c(a.value);break;case"Link.web":i=new d(a.value);break;default:console.log("Type not found:",a.type)}return i}b.prototype={asHtml:function(){return"<span>"+this.value+"</span>"}},c.prototype={asHtml:function(){return"<a></a>"}},d.prototype={asHtml:function(){return"<a href='"+this.value.url+"'>"+this.value.url+"</a>"}},e.prototype={asHtml:function(){return"<span>"+this.value+"</span>"}},f.prototype={asHtml:function(){return"<span>"+this.value+"</span>"}},g.prototype={asHtml:function(){return"<span>"+this.value+"</span>"}},h.prototype={asText:function(){throw new Error("not implemented")},asHtml:function(){return"<time>"+this.value+"</time>"}},i.prototype={asHtml:function(){return"<span>"+this.value+"</span>"}},j.prototype={getView:function(a){return"main"===a?this.main:this.views[a]},asHtml:function(){return this.main.asHtml()}},k.prototype={ratio:function(){return this.width/this.height},asHtml:function(){return"<img src="+this.url+" width="+this.width+" height="+this.height+">"}},m.prototype={getTitle:function(){for(var a=0;a<this.blocks.length;a++){var b=this.blocks[a];if(0==b.type.indexOf("heading"))return b}},getFirstParagraph:function(){for(var a=0;a<this.blocks.length;a++){var b=this.blocks[a];if("paragraph"==b.type)return b}},getParagraphs:function(){for(var a=[],b=0;b<this.blocks.length;b++){var c=this.blocks[b];"paragraph"==c.type&&a.push(c)}return a},getParagraph:function(a){return this.getParagraphs()[a]},getFirstImage:function(){for(var a=0;a<this.blocks.length;a++){var b=this.blocks[a];if("image"==b.type)return new k(b.data.url,b.data.dimensions.width,b.data.dimensions.height)}},asHtml:function(){return n.call(this,this.blocks)}},a.Prismic.Fragments={Image:j,ImageView:k,Text:b,Number:g,Date:h,Select:e,Color:f,StructuredText:m,initField:q}}("object"==typeof exports&&exports?exports:"object"==typeof module&&module&&"object"==typeof module.exports?module.exports:window);